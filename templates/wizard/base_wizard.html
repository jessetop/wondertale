{% extends "base.html" %}

{% block styles %}
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    /* Theme Variables */
    :root {
        --primary: #8B5CF6;
        --primary-dark: #6D28D9;
        --secondary: #EC4899;
        --accent: #14B8A6;
        --accent-light: #5EEAD4;
        --bg-main: #FFF7ED;
        --bg-card: #FFFFFF;
        --text-dark: #1F2937;
        --text-light: #6B7280;
        --shadow: rgba(139, 92, 246, 0.15);
    }

    [data-theme="magic-light"] {
        --primary: #8B5CF6;
        --primary-dark: #6D28D9;
        --secondary: #EC4899;
        --accent: #14B8A6;
        --accent-light: #5EEAD4;
        --bg-main: #FFF7ED;
        --bg-card: #FFFFFF;
        --text-dark: #1F2937;
        --text-light: #6B7280;
        --shadow: rgba(139, 92, 246, 0.15);
    }

    [data-theme="magic-dark"] {
        --primary: #A78BFA;
        --primary-dark: #8B5CF6;
        --secondary: #F472B6;
        --accent: #2DD4BF;
        --accent-light: #5EEAD4;
        --bg-main: #1F1B2E;
        --bg-card: #2D2640;
        --text-dark: #F3F4F6;
        --text-light: #D1D5DB;
        --shadow: rgba(167, 139, 250, 0.3);
    }

    [data-theme="sunny-light"] {
        --primary: #F59E0B;
        --primary-dark: #D97706;
        --secondary: #3B82F6;
        --accent: #FBBF24;
        --accent-light: #FDE68A;
        --bg-main: #FEF3C7;
        --bg-card: #FFFFFF;
        --text-dark: #1F2937;
        --text-light: #6B7280;
        --shadow: rgba(245, 158, 11, 0.15);
    }

    [data-theme="sunny-dark"] {
        --primary: #FCD34D;
        --primary-dark: #F59E0B;
        --secondary: #60A5FA;
        --accent: #FDE047;
        --accent-light: #FEF08A;
        --bg-main: #1E1B16;
        --bg-card: #2C2618;
        --text-dark: #F3F4F6;
        --text-light: #D1D5DB;
        --shadow: rgba(252, 211, 77, 0.3);
    }

    [data-theme="ocean-light"] {
        --primary: #0EA5E9;
        --primary-dark: #0284C7;
        --secondary: #FB7185;
        --accent: #34D399;
        --accent-light: #6EE7B7;
        --bg-main: #F0FDFA;
        --bg-card: #FFFFFF;
        --text-dark: #1F2937;
        --text-light: #6B7280;
        --shadow: rgba(14, 165, 233, 0.15);
    }

    [data-theme="ocean-dark"] {
        --primary: #38BDF8;
        --primary-dark: #0EA5E9;
        --secondary: #FDA4AF;
        --accent: #6EE7B7;
        --accent-light: #A7F3D0;
        --bg-main: #0F1419;
        --bg-card: #1A2332;
        --text-dark: #F3F4F6;
        --text-light: #D1D5DB;
        --shadow: rgba(56, 189, 248, 0.3);
    }

    body {
        font-family: 'Nunito', sans-serif;
        background: var(--bg-main);
        color: var(--text-dark);
        line-height: 1.6;
        min-height: 100vh;
        transition: background-color 0.4s ease, color 0.4s ease;
    }

    .wizard-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    /* Header with integrated navigation */
    .wizard-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 40px;
        padding: 20px 0;
    }

    .header-left {
        display: flex;
        align-items: center;
        gap: 20px;
    }

    .home-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 12px 20px;
        background: var(--bg-card);
        color: var(--text-dark);
        border: 2px solid var(--accent-light);
        border-radius: 12px;
        font-family: 'Nunito', sans-serif;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
    }

    .home-btn:hover {
        border-color: var(--primary);
        color: var(--primary);
        transform: translateY(-2px);
    }

    .logo {
        font-family: 'Fredoka', sans-serif;
        font-size: 32px;
        font-weight: 700;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        display: inline-block;
    }

    /* Progress indicator */
    .progress-container {
        background: var(--bg-card);
        border-radius: 20px;
        padding: 16px 24px;
        box-shadow: 0 4px 16px var(--shadow);
    }

    .progress-bar {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
    }

    .progress-step {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 14px;
        transition: all 0.3s ease;
    }

    .progress-step.completed {
        background: var(--accent);
        color: white;
    }

    .progress-step.current {
        background: var(--primary);
        color: white;
        transform: scale(1.1);
    }

    .progress-step.upcoming {
        background: var(--bg-main);
        color: var(--text-light);
        border: 2px solid var(--accent-light);
    }

    .progress-line {
        flex: 1;
        height: 4px;
        background: var(--bg-main);
        border-radius: 2px;
        position: relative;
        overflow: hidden;
    }

    .progress-line.completed {
        background: var(--accent);
    }

    .progress-text {
        font-size: 14px;
        color: var(--text-light);
        font-weight: 600;
        text-align: center;
    }

    /* Main content area */
    .wizard-content {
        flex: 1;
        background: var(--bg-card);
        border-radius: 32px;
        padding: 48px;
        box-shadow: 0 8px 32px var(--shadow);
        transition: background-color 0.4s ease;
        margin-bottom: 20px;
    }

    .step-title {
        font-family: 'Fredoka', sans-serif;
        font-size: 36px;
        font-weight: 700;
        text-align: center;
        margin-bottom: 16px;
        color: var(--primary);
    }

    .step-subtitle {
        font-size: 18px;
        color: var(--text-light);
        text-align: center;
        margin-bottom: 40px;
        font-weight: 600;
    }

    /* Selection grids */
    .selection-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 16px;
        margin-bottom: 40px;
    }

    .selection-btn {
        background: var(--bg-main);
        border: 4px solid transparent;
        border-radius: 20px;
        padding: 24px 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
        font-family: 'Fredoka', sans-serif;
        font-size: 18px;
        font-weight: 700;
        color: var(--text-dark);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 12px;
        min-height: 140px;
        min-width: 44px;
        justify-content: center;
        position: relative;
        overflow: hidden;
    }

    .selection-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    .selection-btn:hover {
        transform: translateY(-4px);
        border-color: var(--primary);
        box-shadow: 0 8px 24px var(--shadow);
    }

    .selection-btn:hover::before {
        opacity: 0.1;
    }

    .selection-btn.active {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        color: white;
        border-color: var(--primary);
        transform: scale(1.05);
        box-shadow: 0 12px 32px var(--shadow);
    }

    .selection-btn.active::before {
        opacity: 0;
    }

    .selection-icon {
        font-size: 48px;
        line-height: 1;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }

    .selection-text {
        font-size: 18px;
        line-height: 1.2;
        text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    /* Number buttons */
    .number-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
        margin-bottom: 40px;
    }

    .number-btn {
        aspect-ratio: 1;
        background: var(--bg-main);
        border: 4px solid transparent;
        border-radius: 20px;
        cursor: pointer;
        font-family: 'Fredoka', sans-serif;
        font-size: 32px;
        font-weight: 700;
        color: var(--text-dark);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 44px;
        min-height: 44px;
        position: relative;
        overflow: hidden;
    }

    .number-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    .number-btn:hover {
        transform: scale(1.1);
        border-color: var(--primary);
    }

    .number-btn:hover::before {
        opacity: 0.1;
    }

    .number-btn.active {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        color: white;
        border-color: var(--primary);
        transform: scale(1.15);
        box-shadow: 0 8px 24px var(--shadow);
    }

    .number-btn.active::before {
        opacity: 0;
    }

    /* Text inputs */
    input[type="text"] {
        width: 100%;
        padding: 20px 24px;
        font-size: 22px;
        font-family: 'Nunito', sans-serif;
        font-weight: 700;
        border: 4px solid var(--accent-light);
        border-radius: 16px;
        background: var(--bg-main);
        color: var(--text-dark);
        transition: all 0.3s ease;
        outline: none;
        min-height: 44px;
        margin-bottom: 20px;
    }

    input[type="text"]:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 4px var(--shadow);
        transform: translateY(-2px);
    }

    input[type="text"]::placeholder {
        color: var(--text-light);
        opacity: 0.6;
    }

    /* Navigation buttons */
    .wizard-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 20px;
        margin-top: 40px;
    }

    .nav-btn {
        padding: 20px 40px;
        font-family: 'Fredoka', sans-serif;
        font-size: 20px;
        font-weight: 700;
        border-radius: 16px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        min-height: 44px;
        position: relative;
        overflow: hidden;
    }

    .nav-btn-primary {
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
        color: white;
        box-shadow: 0 8px 24px var(--shadow);
    }

    .nav-btn-primary:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 32px var(--shadow);
    }

    .nav-btn-secondary {
        background: var(--bg-main);
        color: var(--text-dark);
        border: 3px solid var(--accent-light);
    }

    .nav-btn-secondary:hover {
        border-color: var(--primary);
        color: var(--primary);
        transform: translateY(-2px);
    }

    .nav-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .wizard-container {
            padding: 16px;
        }

        .wizard-header {
            flex-direction: column;
            gap: 20px;
            align-items: stretch;
        }

        .header-left {
            justify-content: space-between;
        }

        .wizard-content {
            padding: 32px 24px;
        }

        .step-title {
            font-size: 28px;
        }

        .selection-grid {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        }

        .selection-btn {
            padding: 20px 12px;
            min-height: 120px;
        }

        .selection-icon {
            font-size: 40px;
        }

        .selection-text {
            font-size: 16px;
        }

        .wizard-nav {
            flex-direction: column;
        }

        .nav-btn {
            width: 100%;
            justify-content: center;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="wizard-container">
    <div class="wizard-header">
        <div class="header-left">
            <a href="{{ url_for('landing') }}" class="home-btn">
                üè† Home
            </a>
            <div class="logo">WonderTale</div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar">
                {% for i in range(1, 9) %}
                    <div class="progress-step {% if i < current_step %}completed{% elif i == current_step %}current{% else %}upcoming{% endif %}">
                        {% if i < current_step %}‚úì{% else %}{{ i }}{% endif %}
                    </div>
                    {% if i < 8 %}
                    <div class="progress-line {% if i < current_step %}completed{% endif %}"></div>
                    {% endif %}
                {% endfor %}
            </div>
            <div class="progress-text">Step {{ current_step }} of 8</div>
        </div>
    </div>

    <div class="wizard-content">
        {% block wizard_content %}{% endblock %}
    </div>
</div>

{% block wizard_scripts %}{% endblock %}
{% block wizard_styles %}{% endblock %}
{% endblock %}