[build]
builder = "NIXPACKS"

[deploy]
healthcheckPath = "/health"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
# Increase worker timeout to handle OpenAI API calls
healthcheckTimeout = 300
startCommand = "gunicorn --bind 0.0.0.0:$PORT --timeout 60 --workers 2 --worker-class sync app:app"

[env]
FLASK_ENV = "production"
MAX_STORY_LENGTH = "400"
DEFAULT_VOICE_SPEED = "0.8"
PORT = "5000"

# Note: Sensitive variables like OPENAI_API_KEY and FLASK_SECRET_KEY
# should be set in Railway dashboard, not in this file